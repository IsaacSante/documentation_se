(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{358:function(e,t,a){e.exports=a.p+"assets/img/integration.cd142013.png"},359:function(e,t,a){e.exports=a.p+"assets/img/googleifttt.5bf50f39.png"},360:function(e,t,a){e.exports=a.p+"assets/img/ifttthook.40de06b6.png"},361:function(e,t,a){e.exports=a.p+"assets/img/surtrigger.7a136dd3.png"},362:function(e,t,a){e.exports=a.p+"assets/img/action1.f982cabb.png"},363:function(e,t,a){e.exports=a.p+"assets/img/action2.c0272f85.png"},364:function(e,t,a){e.exports=a.p+"assets/img/delaybigsur.cee67acb.png"},365:function(e,t,a){e.exports=a.p+"assets/img/auto_menu.95305ffe.png"},366:function(e,t,a){e.exports=a.p+"assets/img/offall.62bcdf2f.png"},367:function(e,t,a){e.exports=a.p+"assets/img/offall2.b72f2732.png"},368:function(e,t,a){e.exports=a.p+"assets/img/scenelights.5702510d.png"},386:function(e,t,a){"use strict";a.r(t);var s=a(42),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"home-assistant"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#home-assistant"}},[e._v("#")]),e._v(" Home Assistant")]),e._v(" "),s("h2",{attrs:{id:"integrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#integrations"}},[e._v("#")]),e._v(" Integrations")]),e._v(" "),s("p",[e._v("To add an integration go to the sidebar and click on "),s("strong",[e._v("configuration")]),e._v(" on the bottom left. Then go into integrations.")]),e._v(" "),s("p",[e._v("You can search for the integrations and add them.")]),e._v(" "),s("img",{attrs:{src:a(358),width:"600",height:"300"}}),e._v(" "),s("h3",{attrs:{id:"phillips-hue-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#phillips-hue-integration"}},[e._v("#")]),e._v(" Phillips Hue Integration.")]),e._v(" "),s("p",[e._v("If you are on the same WiFi it should automatically connect with all your Phillips light devices and entities. In this case, entities are the zones/rooms you created in the Hue app. These entities will allow us to control all the lights easily when setting up scenes for the rooms.")]),e._v(" "),s("h3",{attrs:{id:"ifttt-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ifttt-integration"}},[e._v("#")]),e._v(" IFTTT Integration")]),e._v(" "),s("p",[e._v("Before we do this we need to setup the IFTTT aplets.")]),e._v(" "),s("p",[e._v("For context IFTTT serves as a middleman between two devices. In the case of the rooms when a user says a specific command to the Google Home Max on our network, a webhook is sent to Home Assisant with a specific JSON post response. Based on the JSON body content, the approapitate automation is triggered.")]),e._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://ifttt.com/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("Go to IFTTT"),s("OutboundLink")],1),e._v("\n... you can sign up with the same google account you are using to manage the Home Assistant.")])]),e._v(" "),s("li",[s("p",[e._v("Create a new applet.")])]),e._v(" "),s("li",[s("p",[e._v("The inital IFTTT trigger device will be "),s("strong",[e._v("Google Assistant")])])]),e._v(" "),s("li",[s("p",[e._v("The IFTTT receiver device being called will be "),s("strong",[e._v("Webhooks")])]),e._v(" "),s("ul",[s("li",[e._v("The google integration will go as follows\n"),s("ul",[s("li",[e._v("In "),s("strong",[e._v("What do you want to say?")]),e._v(' write " activate '),s("strong",[e._v("x")]),e._v(' " ... where '),s("strong",[e._v("x")]),e._v(" stands for the menu or the title of the scene we are creating the webhook for")]),e._v(" "),s("li",[e._v("You can write alternative ways of activating the webhook")]),e._v(" "),s("li",[e._v('You must include a "Â¿" in the response if you want Google Assistant to stay silent after you have given it a command.')])])])]),e._v(" "),s("img",{attrs:{src:a(359),width:"400",height:"500"}}),e._v(" "),s("ul",[s("li",[e._v("The webhook integration will go as follows\n"),s("ul",[s("li",[e._v("For the "),s("strong",[e._v("URL")]),e._v(" we will use the Nabu Casa webhooks url")]),e._v(" "),s("li",[e._v("For "),s("strong",[e._v("Method")]),e._v(" choose "),s("strong",[e._v("POST")])]),e._v(" "),s("li",[e._v("For "),s("strong",[e._v("Content Type")]),e._v(" choose "),s("strong",[e._v("application/json")])]),e._v(" "),s("li",[e._v('In the JSON body type { "name" : "myscenename" }\n'),s("ul",[s("li",[s("strong",[e._v("All the json body names for the scenes are listed in the google doc, under the scenes tab. Please follow the same naming convention.")])])])])])])]),e._v(" "),s("img",{attrs:{src:a(360),width:"400",height:"700"}})])]),e._v(" "),s("h3",{attrs:{id:"google-cast-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#google-cast-integration"}},[e._v("#")]),e._v(" Google Cast Integration")]),e._v(" "),s("p",[e._v("Configure the Google Cast Integration. By default it should pick up on all the connected google devices in our network.")]),e._v(" "),s("h2",{attrs:{id:"automations-overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#automations-overview"}},[e._v("#")]),e._v(" Automations Overview")]),e._v(" "),s("p",[e._v("In order to understand scripts and scenes we need to understand the structure of our automations first. Below is an example automation for the Big Sur video.")]),e._v(" "),s("h3",{attrs:{id:"triggers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#triggers"}},[e._v("#")]),e._v(" Triggers")]),e._v(" "),s("p",[e._v("We start with the name and the trigger. The trigger comes from IFTTT after the user has used one of our specific voice commands.")]),e._v(" "),s("ul",[s("li",[e._v("Name of automation = "),s("strong",[e._v("whatever name you want")])]),e._v(" "),s("li",[e._v("Trigger type  = "),s("strong",[e._v("Event")])]),e._v(" "),s("li",[e._v("Event type = "),s("strong",[e._v("ifttt_webhook_received")])]),e._v(" "),s("li",[e._v("Event data = "),s("strong",[e._v("name: sur")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("The event data name corresponds to the json body name we created for the IFTTT webhook")])]),e._v(" "),s("li",[s("p",[e._v("You can go into the trigger compnent and edit it in YAML script. Here is an example YAML script we used for Big Sur. Make sure to keep indentation the same.")]),e._v(" "),s("ul",[s("li",[e._v("To edit YAML click on the three dots on the top right of the component and click "),s("strong",[e._v("edit as YAML")]),e._v(".")])])])])])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("platform: event\nevent_type: ifttt_webhook_received\nevent_data:\n  name: sur\n")])])]),s("img",{attrs:{src:a(361),width:"700",height:"400"}}),e._v(" "),s("h3",{attrs:{id:"actions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#actions"}},[e._v("#")]),e._v(" Actions")]),e._v(" "),s("p",[e._v("Actions are what Home Assisant does after recieving a trigger. Actions can either be scenes which control our lighting or scripts which can control the timing of our videos and display them on the projector.")]),e._v(" "),s("p",[e._v("We will go over the script in detail in the next section. For now lets just look at the structure. In this automation there are two delay scripts.")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("script.turn_off_all_delays")]),e._v(" "),s("ul",[s("li",[e._v("This script resets all the delays. This way if someone switched videos midway it will stil play the full length of the video.")])])]),e._v(" "),s("li",[s("p",[e._v("script.delay_big_sur_2")]),e._v(" "),s("ul",[s("li",[e._v("The name of this script will differ by automation. This delay script is called a minute before the video ends. At which point is changes the video to the menu.")])])]),e._v(" "),s("li",[s("p",[e._v("Play video call service")]),e._v(" "),s("ul",[s("li",[e._v("This is YAML script. It takes the media player which is our Chromecast, opens the Youtube app and plays our video.")])])])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('service: media_player.play_media\ndata:\n  media_content_type: cast\n  media_content_id: >-\n    {"app_name": "youtube", "playlist_id":"PLoK7c2VKHv7q1OFyDTk4WXZX-iArRi5Ho",\n    "media_id" : "NXfWway52TY"}\nentity_id: media_player.studio_tv\n')])])]),s("ul",[s("li",[s("p",[e._v("Volume video call service")]),e._v(" "),s("ul",[s("li",[e._v("Sets the chromecast volume for every video. Some videos should be louder than others.")])])])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("service: media_player.volume_set\ndata:\n  volume_level: '0.72'\nentity_id: media_player.studio_tv\n")])])]),s("img",{attrs:{src:a(362),width:"700",height:"450"}}),e._v(" "),s("img",{attrs:{src:a(363),width:"700",height:"450"}}),e._v(" "),s("h2",{attrs:{id:"scripts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scripts"}},[e._v("#")]),e._v(" Scripts")]),e._v(" "),s("h3",{attrs:{id:"delay-video-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delay-video-script"}},[e._v("#")]),e._v(" Delay video script")]),e._v(" "),s("ul",[s("li",[e._v("Under the sequence section add a Delay.")])]),e._v(" "),s("img",{attrs:{src:a(364),width:"700",height:"450"}}),e._v(" "),s("p",[e._v("For the delay amount were going to calculate the number of seconds in our video. Then we will sutract a few seconds off that number and use that.")]),e._v(" "),s("p",[e._v("For example the Big Sur automation plays our Emerald Cove video which 21 minutes and 6 seconds, which is 1266 seconds. Minus a few seconds we could write 1263.")]),e._v(" "),s("ul",[s("li",[e._v("Call the menu.\nHere we have a nested automation which is called at the end of the Big Sur automation. If we look at the menu automation it follows the same pattern we layed out above.\n"),s("ul",[s("li",[e._v("Turn off all delays")]),e._v(" "),s("li",[e._v("Cast menu videos")]),e._v(" "),s("li",[e._v("Delay Menu")])])])]),e._v(" "),s("img",{attrs:{src:a(365),width:"700",height:"450"}}),e._v(" "),s("h3",{attrs:{id:"turn-off-all-delays"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#turn-off-all-delays"}},[e._v("#")]),e._v(" Turn off all delays")]),e._v(" "),s("p",[e._v("In the sequence section of this script we do a call service on every individual video delay script and turn them off. The menu video delay script included.")]),e._v(" "),s("p",[e._v("The service type will be "),s("strong",[e._v("script.turn_off")])]),e._v(" "),s("img",{attrs:{src:a(366),width:"700",height:"450"}}),e._v(" "),s("img",{attrs:{src:a(367),width:"700",height:"450"}}),e._v(" "),s("h2",{attrs:{id:"scenes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scenes"}},[e._v("#")]),e._v(" Scenes")]),e._v(" "),s("p",[e._v("Under scenes we can choose our individual lights or we can choose a zone and set the color/brightness/temperature. We can then call these in the automation section.")]),e._v(" "),s("img",{attrs:{src:a(368),width:"600",height:"570"}}),e._v(" "),s("h2",{attrs:{id:"configurations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configurations"}},[e._v("#")]),e._v(" Configurations")]),e._v(" "),s("p",[e._v("At the bottom of the sidebar on Home Assistant you can click the Supervisor tab. Here you can add extensions to Home Assistant. Add the File Editor extension.")]),e._v(" "),s("p",[e._v("The file editor tab should now appear on the sidebar. Click on it and on the folder icon navigate to /config/configuration.yaml .")]),e._v(" "),s("p",[e._v("From here you can specify special condtions that we need our system to have. For example you can specify the Media Extractor which is in charge of supplying our youtube video URL to chromecast during our automations.")]),e._v(" "),s("p",[e._v("Here is an example configuration yaml from the Recharge room at Brockton Signature Hospital.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\n# Configure a default setup of Home Assistant (frontend, api, etc)\ndefault_config:\n\n# Text to speech\ntts:\n  - platform: google_translate\n\ngroup: !include groups.yaml\nautomation: !include automations.yaml\nscript: !include scripts.yaml\nscene: !include scenes.yaml\n\nhue:\n  bridges:\n    - host: 192.168.1.4\n      allow_unreachable: true\n      allow_hue_groups: true\n\nmedia_extractor:\n  customize:\n    media_player.studio_tv:\n      'video/youtube': bestvideo[height=2160]+bestaudio\n")])])]),s("h2",{attrs:{id:"other-features"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-features"}},[e._v("#")]),e._v(" Other features")])])}),[],!1,null,null,null);t.default=o.exports}}]);